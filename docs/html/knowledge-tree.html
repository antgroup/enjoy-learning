<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŸ¥è¯†æ ‘ - æˆ‘çš„çŸ¥è¯†ä½“ç³»</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "PingFang SC", "Helvetica Neue", Arial, sans-serif;
        }

        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            width: 100%;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 56px;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            padding: 0 16px;
            z-index: 100;
        }

        .header-title {
            font-size: 18px;
            font-weight: 600;
            flex: 1;
        }

        .header-actions {
            display: flex;
            gap: 16px;
        }

        .btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
        }

        .btn:hover {
            background-color: #f5f5f5;
        }

        .btn-icon {
            width: 24px;
            height: 24px;
        }

        .search-bar {
            position: fixed;
            top: 70px;
            left: 16px;
            right: 16px;
            height: 44px;
            background-color: #fff;
            border-radius: 22px;
            display: flex;
            align-items: center;
            padding: 0 16px;
            box-shadow: var(--shadow-sm);
            z-index: 90;
        }

        .search-icon {
            width: 20px;
            height: 20px;
            color: #999;
            margin-right: 8px;
        }

        .search-input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 16px;
            color: #333;
        }

        .filter-chips {
            position: fixed;
            top: 130px;
            left: 0;
            right: 0;
            height: 40px;
            padding: 0 16px;
            display: flex;
            gap: 8px;
            overflow-x: auto;
            white-space: nowrap;
            z-index: 80;
        }

        .filter-chip {
            display: inline-flex;
            align-items: center;
            padding: 0 16px;
            height: 32px;
            background-color: #fff;
            border-radius: 16px;
            font-size: 14px;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .filter-chip.active {
            background-color: var(--primary-color-light);
            color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .knowledge-tree-container {
            width: 100%;
            height: 100%;
            padding-top: 180px;
            padding-bottom: 60px; /* ä¸ºåº•éƒ¨å¯¼èˆªæ ç•™å‡ºç©ºé—´ */
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #knowledge-tree {
            width: 100%;
            height: 100%;
            transform-origin: center;
            transition: transform 0.3s ease;
        }

        .node {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .node circle {
            fill: #fff;
            stroke: #1890ff;
            stroke-width: 2px;
        }

        .node-text {
            font-size: 12px;
            font-family: "PingFang SC", sans-serif;
            pointer-events: none;
        }

        .node.highlight circle {
            stroke-width: 3px;
            stroke: #ff4d4f;
        }

        .link {
            fill: none;
            stroke: #ccc;
            stroke-width: 1.5px;
            transition: opacity 0.3s ease;
        }
        
        .node, .node-text {
            transition: opacity 0.3s ease;
        }
        
        .hidden {
            pointer-events: none;
        }

        .zoom-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            z-index: 100;
        }

        .zoom-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #fff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
        }

        .zoom-btn:hover {
            background-color: #f5f5f5;
        }

        .node-details {
            position: fixed;
            bottom: -280px;
            left: 16px;
            right: 16px;
            height: 280px;
            background-color: #fff;
            border-radius: 16px 16px 0 0;
            padding: 24px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            z-index: 100;
        }

        .node-details.show {
            transform: translateY(-280px);
        }

        .node-details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .node-details-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .node-details-close {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: none;
            border: none;
            cursor: pointer;
        }

        .node-details-close:hover {
            background-color: #f5f5f5;
        }

        .node-details-category {
            display: inline-block;
            padding: 4px 12px;
            background-color: #e8f3ff;
            color: #1890ff;
            border-radius: 12px;
            font-size: 12px;
            margin-bottom: 16px;
        }

        .node-details-description {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .node-details-progress {
            margin-bottom: 16px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #999;
            margin-bottom: 4px;
        }

        .progress-bar {
            height: 4px;
            background-color: #f0f0f0;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-value {
            height: 100%;
            background-color: #1890ff;
            border-radius: 2px;
            width: 75%;
        }

        .node-details-related {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .related-nodes {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 8px;
        }

        .related-node {
            padding: 6px 12px;
            background-color: #f5f5f5;
            border-radius: 16px;
            font-size: 12px;
            color: #666;
            white-space: nowrap;
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .filter-chip {
                font-size: 12px;
                padding: 0 12px;
            }
            
            .node-details {
                padding: 16px;
            }
            
            .node-details-title {
                font-size: 18px;
            }
        }
        
        /* é¡¶éƒ¨å¯¼èˆªæ æ ·å¼ */
        .navbar {
            height: 56px;
            background-color: white;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
        }
        
        .navbar-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .navbar-actions .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            transition: all 0.2s ease;
            box-shadow: none;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            border-radius: 4px;
            padding: 6px 12px; /* è°ƒæ•´å†…è¾¹è·ä»¥åŒ¹é…çŸ¥è¯†åœ°å›¾ */
            background: none;
            cursor: pointer;
            font-size: 14px;
        }
        
        .navbar-actions .btn:hover {
            background-color: rgba(30, 136, 229, 0.1);
            transform: translateY(-1px);
        }
        
        /* è§†å›¾åˆ‡æ¢èœå• */
        .view-switch-menu {
            position: absolute;
            top: 56px;
            right: 16px;
            background-color: white;
            border-radius: 12px;
            box-shadow: var(--shadow-md);
            z-index: 100;
            overflow: hidden;
            display: none;
            transition: all 0.3s ease;
            transform-origin: top right;
            transform: scale(0.9);
            opacity: 0;
            width: 240px;
        }
        
        .view-switch-menu.show {
            display: block !important;
            transform: scale(1);
            opacity: 1;
        }

        .view-option {
            padding: 16px 20px;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid var(--divider-color);
        }
        
        .view-option:last-child {
            border-bottom: none;
        }
        
        .view-option:hover {
            background-color: var(--bg-gray);
        }
        
        .view-option span:first-child {
            font-size: 24px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .view-option span:last-child {
            font-weight: 500;
            font-size: 16px;
        }
        
        /* åº•éƒ¨å¯¼èˆªæ  */
        .bottom-nav {
            height: 60px;
            background-color: white;
            border-top: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: space-around;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
        }
        
        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #666;
            text-decoration: none;
            font-size: 12px;
            flex: 1;
            padding: 8px 0;
        }
        
        .bottom-nav-item.active {
            color: #1890ff;
        }
        
        .bottom-nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <div class="navbar">
            <div class="navbar-title">çŸ¥è¯†æ ‘</div>
            <div class="navbar-actions">
                <button class="btn btn-sm btn-outline" id="viewSwitchBtn">
                    <span>è§†å›¾åˆ‡æ¢</span>
                    <span style="margin-left: 5px; display: inline-block;">â–¼</span>
                </button>
            </div>
        </div>

        <!-- è§†å›¾åˆ‡æ¢èœå• -->
        <div class="view-switch-menu show" id="viewSwitchMenu">
            <div class="view-option" data-view="map">
                <span>ğŸŒ</span>
                <span>çŸ¥è¯†åœ°å›¾</span>
            </div>
            <div class="view-option" data-view="tree">
                <span>ğŸŒ³</span>
                <span>çŸ¥è¯†æ ‘</span>
            </div>
            <div class="view-option" data-view="globe">
                <span>ğŸ”®</span>
                <span>çŸ¥è¯†çƒ</span>
            </div>
        </div>
        
        <div class="search-bar">
            <svg class="search-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z" fill="currentColor"/>
            </svg>
            <input type="text" class="search-input" placeholder="æœç´¢çŸ¥è¯†ç‚¹...">
        </div>
        
        <div class="filter-chips">
            <div class="filter-chip active">å…¨éƒ¨</div>
            <div class="filter-chip">å‰ç«¯å¼€å‘</div>
            <div class="filter-chip">åç«¯æŠ€æœ¯</div>
            <div class="filter-chip">æ•°æ®ç§‘å­¦</div>
            <div class="filter-chip">è®¾è®¡ç†è®º</div>
            <div class="filter-chip">äº§å“ç®¡ç†</div>
            <div class="filter-chip">äººå·¥æ™ºèƒ½</div>
        </div>
        
        <div class="knowledge-tree-container">
            <svg id="knowledge-tree"></svg>
        </div>
        
        <div class="zoom-controls">
            <button class="zoom-btn" id="zoom-in">+</button>
            <button class="zoom-btn" id="zoom-out">-</button>
            <button class="zoom-btn" id="zoom-reset">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 5V1L7 6L12 11V7C15.31 7 18 9.69 18 13C18 16.31 15.31 19 12 19C8.69 19 6 16.31 6 13H4C4 17.42 7.58 21 12 21C16.42 21 20 17.42 20 13C20 8.58 16.42 5 12 5Z" fill="currentColor"/>
                </svg>
            </button>
        </div>
        
        <div class="node-details">
            <div class="node-details-header">
                <h2 class="node-details-title">JavaScript åŸºç¡€</h2>
                <button class="node-details-close">Ã—</button>
            </div>
            <div class="node-details-category">å‰ç«¯å¼€å‘</div>
            <p class="node-details-description">JavaScript æ˜¯ä¸€ç§å…·æœ‰å‡½æ•°ä¼˜å…ˆçš„è½»é‡çº§ï¼Œè§£é‡Šå‹æˆ–å³æ—¶ç¼–è¯‘å‹çš„ç¼–ç¨‹è¯­è¨€ã€‚è™½ç„¶å®ƒæ˜¯ä½œä¸ºå¼€å‘ Web é¡µé¢çš„è„šæœ¬è¯­è¨€è€Œå‡ºåï¼Œä½†æ˜¯å®ƒä¹Ÿè¢«ç”¨åˆ°äº†å¾ˆå¤šéæµè§ˆå™¨ç¯å¢ƒä¸­ã€‚</p>
            <div class="node-details-progress">
                <div class="progress-label">
                    <span>å­¦ä¹ è¿›åº¦</span>
                    <span>75%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-value"></div>
                </div>
            </div>
            <div class="node-details-related">ç›¸å…³çŸ¥è¯†ç‚¹</div>
            <div class="related-nodes">
                <div class="related-node">å˜é‡ä¸æ•°æ®ç±»å‹</div>
                <div class="related-node">å‡½æ•°ä¸ä½œç”¨åŸŸ</div>
                <div class="related-node">äº‹ä»¶å¾ªç¯</div>
                <div class="related-node">DOM æ“ä½œ</div>
                <div class="related-node">ES6+ç‰¹æ€§</div>
            </div>
        </div>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>
        // çŸ¥è¯†æ ‘æ•°æ®
        const treeData = {
            name: "æˆ‘çš„çŸ¥è¯†ä½“ç³»",
            category: "æ ¸å¿ƒ",
            children: [
                {
                    name: "å‰ç«¯å¼€å‘",
                    category: "æŠ€æœ¯",
                    progress: 80,
                    description: "å‰ç«¯å¼€å‘æ˜¯åˆ›å»ºç½‘ç«™æˆ–åº”ç”¨çš„Webç•Œé¢å‘ˆç°ç»™ç”¨æˆ·çš„è¿‡ç¨‹ã€‚å‰ç«¯å¼€å‘äººå‘˜é€šè¿‡HTMLã€CSSå’ŒJavaScriptä»¥åŠè¯¸å¦‚Reactç­‰æ¡†æ¶åˆ›å»ºç”¨æˆ·ç•Œé¢å’Œäº¤äº’æ•ˆæœã€‚",
                    children: [
                        {
                            name: "HTML5",
                            category: "å‰ç«¯å¼€å‘",
                            progress: 90,
                            description: "HTML5æ˜¯HTMLçš„æœ€æ–°ç‰ˆæœ¬ï¼Œæä¾›äº†æ›´å¤šçš„å¤šåª’ä½“å…ƒç´ ï¼Œå¦‚<video>ã€<audio>å’ŒCanvasï¼Œå¹¶æ”¯æŒå“åº”å¼Webè®¾è®¡ã€‚",
                            relatedNodes: ["CSS3", "Web API", "è¯­ä¹‰åŒ–æ ‡ç­¾", "WebComponents"]
                        },
                        {
                            name: "CSS3",
                            category: "å‰ç«¯å¼€å‘",
                            progress: 85,
                            description: "CSS3æ˜¯CSSçš„æœ€æ–°æ ‡å‡†ï¼Œæ·»åŠ äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œå¦‚åŠ¨ç”»ã€è¿‡æ¸¡ã€å˜æ¢å’Œå¼¹æ€§ç›’å­å¸ƒå±€ç­‰ï¼Œä½¿ç½‘é¡µè®¾è®¡æ›´åŠ çµæ´»å’ŒåŠ¨æ€ã€‚",
                            relatedNodes: ["HTML5", "å“åº”å¼è®¾è®¡", "Sass/Less", "åŠ¨ç”»"]
                        },
                        {
                            name: "JavaScript",
                            category: "å‰ç«¯å¼€å‘",
                            progress: 75,
                            description: "JavaScriptæ˜¯ä¸€ç§å…·æœ‰å‡½æ•°ä¼˜å…ˆçš„è½»é‡çº§ï¼Œè§£é‡Šå‹æˆ–å³æ—¶ç¼–è¯‘å‹çš„ç¼–ç¨‹è¯­è¨€ã€‚è™½ç„¶å®ƒæ˜¯ä½œä¸ºå¼€å‘Webé¡µé¢çš„è„šæœ¬è¯­è¨€è€Œå‡ºåï¼Œä½†æ˜¯å®ƒä¹Ÿè¢«ç”¨åˆ°äº†å¾ˆå¤šéæµè§ˆå™¨ç¯å¢ƒä¸­ã€‚",
                            children: [
                                {
                                    name: "ES6+",
                                    category: "å‰ç«¯å¼€å‘",
                                    progress: 70,
                                    description: "ES6ï¼ˆECMAScript 2015ï¼‰åŠæ›´é«˜ç‰ˆæœ¬å¼•å…¥äº†å¾ˆå¤šæ–°ç‰¹æ€§ï¼Œå¦‚ç®­å¤´å‡½æ•°ã€ç±»ã€æ¨¡å—ã€æ¨¡æ¿å­—ç¬¦ä¸²ã€è§£æ„èµ‹å€¼ç­‰ï¼Œä½¿JavaScriptæ›´åŠ å¼ºå¤§å’Œæ˜“ç”¨ã€‚",
                                    relatedNodes: ["Babel", "TypeScript", "æ¨¡å—åŒ–", "å¼‚æ­¥ç¼–ç¨‹"]
                                },
                                {
                                    name: "DOMæ“ä½œ",
                                    category: "å‰ç«¯å¼€å‘",
                                    progress: 85,
                                    description: "DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰æ˜¯HTMLå’ŒXMLæ–‡æ¡£çš„ç¼–ç¨‹æ¥å£ã€‚DOMæ“ä½œå…è®¸JavaScriptè®¿é—®å’Œä¿®æ”¹æ–‡æ¡£çš„å†…å®¹ã€ç»“æ„å’Œæ ·å¼ã€‚",
                                    relatedNodes: ["äº‹ä»¶å¤„ç†", "BOM", "jQuery", "æ“ä½œAPI"]
                                },
                                {
                                    name: "å¼‚æ­¥ç¼–ç¨‹",
                                    category: "å‰ç«¯å¼€å‘",
                                    progress: 65,
                                    description: "å¼‚æ­¥ç¼–ç¨‹æ˜¯å¤„ç†éé˜»å¡æ“ä½œçš„ç¼–ç¨‹èŒƒå¼ã€‚åœ¨JavaScriptä¸­ï¼Œå¼‚æ­¥ç¼–ç¨‹é€šå¸¸ä½¿ç”¨å›è°ƒå‡½æ•°ã€Promiseã€async/awaitç­‰æŠ€æœ¯å®ç°ã€‚",
                                    relatedNodes: ["Promise", "async/await", "äº‹ä»¶å¾ªç¯", "å›è°ƒå‡½æ•°"]
                                }
                            ]
                        },
                        {
                            name: "React",
                            category: "å‰ç«¯å¼€å‘",
                            progress: 80,
                            description: "Reactæ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„JavaScriptåº“ã€‚å®ƒé‡‡ç”¨ç»„ä»¶åŒ–å’Œå£°æ˜å¼ç¼–ç¨‹ï¼Œä½¿å‰ç«¯å¼€å‘æ›´åŠ æ¨¡å—åŒ–å’Œå¯ç»´æŠ¤ã€‚",
                            children: [
                                {
                                    name: "Hooks",
                                    category: "å‰ç«¯å¼€å‘",
                                    progress: 75,
                                    description: "Hooksæ˜¯React 16.8ä¸­æ–°å¢çš„ç‰¹æ€§ï¼Œå®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ç±»çš„æƒ…å†µä¸‹ä½¿ç”¨stateä»¥åŠå…¶ä»–çš„Reactç‰¹æ€§ã€‚",
                                    relatedNodes: ["useState", "useEffect", "useContext", "è‡ªå®šä¹‰Hooks"]
                                },
                                {
                                    name: "Redux",
                                    category: "å‰ç«¯å¼€å‘",
                                    progress: 70,
                                    description: "Reduxæ˜¯JavaScriptåº”ç”¨çš„çŠ¶æ€å®¹å™¨ï¼Œæä¾›å¯é¢„æµ‹çš„çŠ¶æ€ç®¡ç†ã€‚å®ƒé€šå¸¸ä¸Reactä¸€èµ·ä½¿ç”¨ï¼Œä½†ä¹Ÿå¯ä»¥ä¸ä»»ä½•å…¶ä»–è§†å›¾åº“ä¸€èµ·ä½¿ç”¨ã€‚",
                                    relatedNodes: ["çŠ¶æ€ç®¡ç†", "ä¸­é—´ä»¶", "Action", "Reducer"]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "åç«¯æŠ€æœ¯",
                    category: "æŠ€æœ¯",
                    progress: 65,
                    description: "åç«¯å¼€å‘æ˜¯æ„å»ºåº”ç”¨ç¨‹åºæœåŠ¡å™¨ç«¯é€»è¾‘çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®åº“è®¾è®¡ã€APIå¼€å‘ã€ä¸šåŠ¡é€»è¾‘å®ç°ç­‰ã€‚åç«¯æŠ€æœ¯åŒ…æ‹¬è¯¸å¦‚Node.jsã€Javaã€Pythonç­‰è¯­è¨€å’Œç›¸å…³æ¡†æ¶ã€‚",
                    children: [
                        {
                            name: "Node.js",
                            category: "åç«¯æŠ€æœ¯",
                            progress: 75,
                            description: "Node.jsæ˜¯ä¸€ä¸ªåŸºäºChrome V8å¼•æ“çš„JavaScriptè¿è¡Œæ—¶ç¯å¢ƒï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨JavaScriptæ„å»ºæœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºã€‚",
                            children: [
                                {
                                    name: "Express",
                                    category: "åç«¯æŠ€æœ¯",
                                    progress: 80,
                                    description: "Expressæ˜¯ä¸€ä¸ªç®€æ´çµæ´»çš„Node.js Webåº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œæä¾›äº†ä¸€ç³»åˆ—å¼ºå¤§çš„åŠŸèƒ½ï¼Œç”¨äºåˆ›å»ºå„ç§Webå’Œç§»åŠ¨è®¾å¤‡åº”ç”¨ã€‚",
                                    relatedNodes: ["ä¸­é—´ä»¶", "è·¯ç”±", "REST API", "æ¨¡æ¿å¼•æ“"]
                                }
                            ]
                        },
                        {
                            name: "æ•°æ®åº“",
                            category: "åç«¯æŠ€æœ¯",
                            progress: 60,
                            description: "æ•°æ®åº“æ˜¯ç»“æ„åŒ–ä¿¡æ¯æˆ–æ•°æ®çš„æœ‰ç»„ç»‡çš„é›†åˆï¼Œé€šå¸¸ä»¥ç”µå­å½¢å¼å­˜å‚¨åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ã€‚æ•°æ®åº“é€šå¸¸ç”±æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ(DBMS)æ§åˆ¶ã€‚",
                            children: [
                                {
                                    name: "SQL",
                                    category: "åç«¯æŠ€æœ¯",
                                    progress: 65,
                                    description: "SQLï¼ˆç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼‰æ˜¯ç”¨äºç®¡ç†å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ ‡å‡†è¯­è¨€ã€‚å®ƒç”¨äºå­˜å‚¨ã€æ“ä½œå’Œæ£€ç´¢æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚",
                                    relatedNodes: ["MySQL", "PostgreSQL", "å…³ç³»å‹æ•°æ®åº“", "æŸ¥è¯¢ä¼˜åŒ–"]
                                },
                                {
                                    name: "MongoDB",
                                    category: "åç«¯æŠ€æœ¯",
                                    progress: 55,
                                    description: "MongoDBæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„é¢å‘æ–‡æ¡£çš„æ•°æ®åº“ç¨‹åºã€‚å®ƒæ˜¯ä¸€ç§NoSQLæ•°æ®åº“ï¼Œä½¿ç”¨ç±»ä¼¼JSONçš„BSONæ–‡æ¡£å­˜å‚¨æ•°æ®ã€‚",
                                    relatedNodes: ["NoSQL", "æ–‡æ¡£æ•°æ®åº“", "èšåˆæŸ¥è¯¢", "æ•°æ®æ¨¡å‹"]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "è®¾è®¡ç†è®º",
                    category: "è®¾è®¡",
                    progress: 70,
                    description: "è®¾è®¡ç†è®ºæ˜¯å…³äºå¦‚ä½•åˆ›å»ºæœ‰æ•ˆå’Œå¸å¼•äººçš„è§†è§‰ä¼ è¾¾çš„åŸåˆ™å’Œè§„åˆ™çš„é›†åˆã€‚å®ƒåŒ…æ‹¬è‰²å½©ç†è®ºã€æ’ç‰ˆå­¦ã€å¸ƒå±€åŸåˆ™ç­‰æ–¹é¢çš„çŸ¥è¯†ã€‚",
                    children: [
                        {
                            name: "UIè®¾è®¡",
                            category: "è®¾è®¡",
                            progress: 75,
                            description: "UIï¼ˆç”¨æˆ·ç•Œé¢ï¼‰è®¾è®¡æ˜¯åˆ›å»ºç”¨æˆ·ä¸è®¾å¤‡æˆ–åº”ç”¨ç¨‹åºäº¤äº’çš„ç•Œé¢çš„è¿‡ç¨‹ã€‚å¥½çš„UIè®¾è®¡ä½¿äº¤äº’å˜å¾—ç®€å•ã€ç›´è§‚å’Œæ„‰å¿«ã€‚",
                            children: [
                                {
                                    name: "è‰²å½©ç†è®º",
                                    category: "è®¾è®¡",
                                    progress: 80,
                                    description: "è‰²å½©ç†è®ºæ˜¯ç ”ç©¶é¢œè‰²çš„æ··åˆåŠå…¶åœ¨è§†è§‰è®¾è®¡ä¸­çš„åº”ç”¨çš„å­¦ç§‘ã€‚å®ƒåŒ…æ‹¬è‰²è½®ã€è‰²å½©å’Œè°ã€è‰²å½©å¿ƒç†å­¦ç­‰æ¦‚å¿µã€‚",
                                    relatedNodes: ["è‰²å½©å¿ƒç†å­¦", "é…è‰²æ–¹æ¡ˆ", "å“ç‰Œè‰²", "è‰²å½©å¯è®¿é—®æ€§"]
                                },
                                {
                                    name: "æ’ç‰ˆ",
                                    category: "è®¾è®¡",
                                    progress: 70,
                                    description: "æ’ç‰ˆæ˜¯é€‰æ‹©å’Œå®‰æ’å­—ä½“ã€è¡Œé—´è·ã€å­—æ¯é—´è·ç­‰ä»¥ä½¿ä¹¦é¢è¯­è¨€å¯è¯»ã€å¯ç†è§£å’Œå¸å¼•äººçš„è‰ºæœ¯ã€‚",
                                    relatedNodes: ["å­—ä½“é€‰æ‹©", "æ–‡æœ¬å±‚æ¬¡ç»“æ„", "å¯è¯»æ€§", "ç½‘æ ¼ç³»ç»Ÿ"]
                                }
                            ]
                        },
                        {
                            name: "UXè®¾è®¡",
                            category: "è®¾è®¡",
                            progress: 65,
                            description: "UXï¼ˆç”¨æˆ·ä½“éªŒï¼‰è®¾è®¡æ˜¯æé«˜ç”¨æˆ·å¯¹äº§å“æˆ–æœåŠ¡çš„æ»¡æ„åº¦çš„è¿‡ç¨‹ï¼Œé€šè¿‡æ”¹å–„å¯ç”¨æ€§ã€æ˜“ç”¨æ€§å’Œä¸äº§å“äº’åŠ¨çš„æ„‰æ‚¦ç¨‹åº¦æ¥å®ç°ã€‚",
                            children: [
                                {
                                    name: "ç”¨æˆ·ç ”ç©¶",
                                    category: "è®¾è®¡",
                                    progress: 60,
                                    description: "ç”¨æˆ·ç ”ç©¶æ˜¯é€šè¿‡å„ç§æ–¹æ³•æ”¶é›†å…³äºç”¨æˆ·éœ€æ±‚ã€è¡Œä¸ºå’ŒåŠ¨æœºçš„ä¿¡æ¯ï¼Œä»¥åˆ›å»ºæ›´ç¬¦åˆç”¨æˆ·éœ€æ±‚çš„äº§å“æˆ–æœåŠ¡ã€‚",
                                    relatedNodes: ["ç”¨æˆ·è®¿è°ˆ", "è°ƒæŸ¥é—®å·", "ç”¨æˆ·ç”»åƒ", "å¯ç”¨æ€§æµ‹è¯•"]
                                },
                                {
                                    name: "äº¤äº’è®¾è®¡",
                                    category: "è®¾è®¡",
                                    progress: 70,
                                    description: "äº¤äº’è®¾è®¡æ˜¯åˆ›å»ºç”¨æˆ·ä¸äº§å“æˆ–æœåŠ¡ä¹‹é—´çš„äº’åŠ¨çš„è¿‡ç¨‹ã€‚å®ƒå…³æ³¨å¦‚ä½•ä½¿äº¤äº’å˜å¾—ç›´è§‚ã€é«˜æ•ˆå’Œæ„‰å¿«ã€‚",
                                    relatedNodes: ["ä¿¡æ¯æ¶æ„", "åŸå‹è®¾è®¡", "å¯¼èˆªè®¾è®¡", "åé¦ˆè®¾è®¡"]
                                }
                            ]
                        }
                    ]
                }
            ]
        };

        // åˆå§‹åŒ–çŸ¥è¯†æ ‘å¯è§†åŒ–
        function initKnowledgeTree() {
            const width = window.innerWidth;
            const height = window.innerHeight - 170;
            
            // æ¸…ç©ºSVG
            d3.select("#knowledge-tree").selectAll("*").remove();
            
            // åˆ›å»ºå…·æœ‰å›ºå®šIDçš„å®¹å™¨ç»„
            d3.select("#knowledge-tree")
                .attr("width", width)
                .attr("height", height);
            
            // åˆ›å»ºå¯ç¼©æ”¾çš„è§†å›¾å®¹å™¨
            const svg = d3.select("#knowledge-tree")
                .append("g")
                .attr("id", "knowledge-tree-container")
                .attr("transform", `translate(${width / 2},${height / 2})`);
            
            // åˆ›å»ºæ ‘å½¢å¸ƒå±€
            const tree = d3.tree()
                .size([2 * Math.PI, Math.min(width, height) / 2 - 100])
                .separation((a, b) => (a.parent === b.parent ? 1 : 2) / a.depth);
            
            // åˆ›å»ºæ ¹èŠ‚ç‚¹
            const root = d3.hierarchy(treeData);
            
            // è®¡ç®—èŠ‚ç‚¹å’Œè¿æ¥çº¿çš„ä½ç½®
            const treeLayout = tree(root);
            
            // å®šä¹‰æ˜¾ç¤ºé€»è¾‘è¾…åŠ©å‡½æ•°
            function shouldShowNode(d, scale) {
                // æ ¹èŠ‚ç‚¹ã€ä¸€çº§èŠ‚ç‚¹å’ŒäºŒçº§èŠ‚ç‚¹å§‹ç»ˆæ˜¾ç¤º
                if (d.depth <= 2) return true;
                // ä¸‰çº§èŠ‚ç‚¹åªåœ¨æ”¾å¤§æ—¶æ˜¾ç¤º
                if (d.depth === 3 && scale >= 1.3) return true;
                // æ›´æ·±å±‚çº§åªåœ¨è¿›ä¸€æ­¥æ”¾å¤§æ—¶æ˜¾ç¤º
                if (d.depth > 3 && scale >= 1.8) return true;
                return false;
            }
            
            // æ·»åŠ æ‰€æœ‰è¿æ¥çº¿ï¼ˆåŒ…æ‹¬éšè—çš„ï¼‰
            const allLinks = svg.selectAll(".link")
                .data(root.links())
                .enter()
                .append("path")
                .attr("class", d => `link ${shouldShowNode(d.target, 1) ? "visible" : "hidden"}`)
                .attr("d", d3.linkRadial()
                    .angle(d => d.x)
                    .radius(d => d.y))
                .style("opacity", d => shouldShowNode(d.target, 1) ? 1 : 0);
            
            // æ·»åŠ èŠ‚ç‚¹ç»„
            const node = svg.selectAll(".node")
                .data(root.descendants())
                .enter()
                .append("g")
                .attr("class", d => `node ${d.data.name === "JavaScript" ? "highlight" : ""} ${shouldShowNode(d, 1) ? "visible" : "hidden"}`)
                .attr("transform", d => {
                    const [x, y] = radialPoint(d.x, d.y);
                    return `translate(${x},${y})`;
                })
                .style("opacity", d => shouldShowNode(d, 1) ? 1 : 0)
                .on("click", handleNodeClick);
            
            // æ·»åŠ èŠ‚ç‚¹åœ†å½¢
            node.append("circle")
                .attr("r", d => d.depth === 0 ? 12 : d.children ? 8 : 6)
                .style("fill", d => getColorByCategory(d.data.category));
            
            // åˆ›å»ºå•ç‹¬çš„æ–‡æœ¬å…ƒç´ ç»„
            const nodeTexts = svg.selectAll(".node-text")
                .data(root.descendants())
                .enter()
                .append("text")
                .attr("class", d => `node-text ${shouldShowNode(d, 1) ? "visible" : "hidden"}`)
                .attr("dy", "0.35em")
                .attr("text-anchor", "middle")
                .text(d => d.data.name)
                .style("fill", "#333")
                .style("font-size", d => d.depth === 0 ? "16px" : "12px")
                .style("font-weight", d => d.depth <= 1 ? "bold" : "normal")
                .style("opacity", d => shouldShowNode(d, 1) ? 1 : 0)
                .attr("transform", function(d) {
                    const angle = d.x - Math.PI/2;
                    // ä¸ºä¸åŒå±‚çº§èŠ‚ç‚¹è°ƒæ•´æ–‡æœ¬åç§»é‡
                    let offset;
                    if (d.depth === 0) offset = 0;      // æ ¹èŠ‚ç‚¹
                    else if (d.depth === 1) offset = 25; // ç¬¬ä¸€å±‚èŠ‚ç‚¹
                    else if (d.depth === 2) offset = 35; // ç¬¬äºŒå±‚èŠ‚ç‚¹
                    else offset = 40;                    // æ›´å¤–å±‚èŠ‚ç‚¹
                    
                    // è®¡ç®—èŠ‚ç‚¹å¤–å›´çš„ä½ç½®
                    const textRadius = d.y + offset;
                    const x = textRadius * Math.cos(angle);
                    const y = textRadius * Math.sin(angle);
                    
                    return `translate(${x},${y})`;
                });
            
            // ç¼©æ”¾åŠŸèƒ½
            let currentScale = 1;
            
            // æ›´æ–°èŠ‚ç‚¹æ˜¾ç¤ºçŠ¶æ€çš„å‡½æ•°
            function updateNodeVisibility(scale) {
                // æ›´æ–°èŠ‚ç‚¹å¯è§æ€§
                node.style("opacity", d => shouldShowNode(d, scale) ? 1 : 0)
                    .classed("visible", d => shouldShowNode(d, scale))
                    .classed("hidden", d => !shouldShowNode(d, scale));
                
                // æ›´æ–°æ–‡æœ¬å¯è§æ€§
                nodeTexts.style("opacity", d => shouldShowNode(d, scale) ? 1 : 0)
                    .classed("visible", d => shouldShowNode(d, scale))
                    .classed("hidden", d => !shouldShowNode(d, scale));
                
                // æ›´æ–°è¿æ¥çº¿å¯è§æ€§
                allLinks.style("opacity", d => shouldShowNode(d.target, scale) ? 1 : 0)
                    .classed("visible", d => shouldShowNode(d.target, scale))
                    .classed("hidden", d => !shouldShowNode(d.target, scale));
            }
            
            // åˆ›å»ºç¼©æ”¾è¡Œä¸º
            const zoom = d3.zoom()
                .scaleExtent([0.5, 3])
                .on("zoom", (event) => {
                    // åªæ”¹å˜ç¼©æ”¾æ¯”ä¾‹ï¼Œä¿æŒä¸­å¿ƒç‚¹ä¸å˜
                    d3.select("#knowledge-tree-container")
                        .attr("transform", `translate(${width/2}, ${height/2}) scale(${event.transform.k})`);
                    
                    currentScale = event.transform.k;
                    
                    // æ ¹æ®ç¼©æ”¾æ¯”ä¾‹æ›´æ–°èŠ‚ç‚¹æ˜¾ç¤º
                    updateNodeVisibility(currentScale);
                });
            
            // åº”ç”¨ç¼©æ”¾è¡Œä¸ºåˆ°SVG
            d3.select("#knowledge-tree").call(zoom);
            
            // ç¼©æ”¾æŒ‰é’®äº‹ä»¶
            d3.select("#zoom-in").on("click", () => {
                currentScale = Math.min(currentScale + 0.2, 3);
                
                // è®¾ç½®å˜æ¢ï¼Œä¿æŒä¸­å¿ƒç‚¹
                d3.select("#knowledge-tree").transition()
                    .duration(300)
                    .call(zoom.transform, d3.zoomIdentity.scale(currentScale));
            });
            
            d3.select("#zoom-out").on("click", () => {
                currentScale = Math.max(currentScale - 0.2, 0.5);
                
                // è®¾ç½®å˜æ¢ï¼Œä¿æŒä¸­å¿ƒç‚¹
                d3.select("#knowledge-tree").transition()
                    .duration(300)
                    .call(zoom.transform, d3.zoomIdentity.scale(currentScale));
            });
            
            d3.select("#zoom-reset").on("click", () => {
                currentScale = 1;
                
                // é‡ç½®å˜æ¢
                d3.select("#knowledge-tree").transition()
                    .duration(300)
                    .call(zoom.transform, d3.zoomIdentity);
            });
            
            // èŠ‚ç‚¹ç‚¹å‡»äº‹ä»¶
            function handleNodeClick(event, d) {
                const details = document.querySelector(".node-details");
                const title = document.querySelector(".node-details-title");
                const category = document.querySelector(".node-details-category");
                const description = document.querySelector(".node-details-description");
                const progressValue = document.querySelector(".progress-value");
                const progressText = document.querySelector(".progress-label span:last-child");
                const relatedNodes = document.querySelector(".related-nodes");
                
                // æ›´æ–°èŠ‚ç‚¹è¯¦æƒ…
                title.textContent = d.data.name;
                category.textContent = d.data.category;
                description.textContent = d.data.description || "æš‚æ— æè¿°";
                
                if (d.data.progress) {
                    progressValue.style.width = d.data.progress + "%";
                    progressText.textContent = d.data.progress + "%";
                } else {
                    progressValue.style.width = "0%";
                    progressText.textContent = "0%";
                }
                
                // æ›´æ–°ç›¸å…³èŠ‚ç‚¹
                relatedNodes.innerHTML = "";
                if (d.data.relatedNodes) {
                    d.data.relatedNodes.forEach(node => {
                        const div = document.createElement("div");
                        div.className = "related-node";
                        div.textContent = node;
                        relatedNodes.appendChild(div);
                    });
                } else {
                    const div = document.createElement("div");
                    div.className = "related-node";
                    div.textContent = "æš‚æ— ç›¸å…³çŸ¥è¯†ç‚¹";
                    relatedNodes.appendChild(div);
                }
                
                // æ˜¾ç¤ºèŠ‚ç‚¹è¯¦æƒ…
                details.classList.add("show");
            }
            
            // å…³é—­èŠ‚ç‚¹è¯¦æƒ…
            document.querySelector(".node-details-close").addEventListener("click", () => {
                document.querySelector(".node-details").classList.remove("show");
            });
            
            // ç­›é€‰äº‹ä»¶
            document.querySelectorAll(".filter-chip").forEach(chip => {
                chip.addEventListener("click", function() {
                    document.querySelectorAll(".filter-chip").forEach(c => c.classList.remove("active"));
                    this.classList.add("active");
                    
                    const category = this.textContent;
                    if (category === "å…¨éƒ¨") {
                        // æ¢å¤æ­£å¸¸æ˜¾ç¤ºçŠ¶æ€
                        updateNodeVisibility(currentScale);
                    } else {
                        // åœ¨å½“å‰æ˜¾ç¤ºçš„èŠ‚ç‚¹ä¸­è¿›è¡Œç­›é€‰
                        node.style("opacity", d => 
                            shouldShowNode(d, currentScale) ? 
                                (d.data.category === category ? 1 : 0.3) : 0
                        );
                        
                        nodeTexts.style("opacity", d => 
                            shouldShowNode(d, currentScale) ? 
                                (d.data.category === category ? 1 : 0.3) : 0
                        );
                        
                        allLinks.style("opacity", d => 
                            shouldShowNode(d.target, currentScale) ? 
                                (d.target.data.category === category ? 1 : 0.3) : 0
                        );
                    }
                });
            });
        }
        
        // è¾…åŠ©å‡½æ•° - æåæ ‡è½¬ç¬›å¡å°”åæ ‡
        function radialPoint(x, y) {
            return [(y = +y) * Math.cos(x -= Math.PI / 2), y * Math.sin(x)];
        }
        
        // æ ¹æ®ç±»åˆ«è·å–é¢œè‰²
        function getColorByCategory(category) {
            const colorMap = {
                "æ ¸å¿ƒ": "#1890ff",
                "æŠ€æœ¯": "#52c41a",
                "è®¾è®¡": "#722ed1",
                "å‰ç«¯å¼€å‘": "#fa8c16",
                "åç«¯æŠ€æœ¯": "#13c2c2",
                "äº§å“ç®¡ç†": "#eb2f96"
            };
            
            return colorMap[category] || "#1890ff";
        }
        
        // åˆå§‹åŒ–çŸ¥è¯†æ ‘
        document.addEventListener("DOMContentLoaded", initKnowledgeTree);
        
        // çª—å£å¤§å°å˜åŒ–æ—¶é‡æ–°ç»˜åˆ¶
        window.addEventListener("resize", initKnowledgeTree);
        
        // è§†å›¾åˆ‡æ¢åŠŸèƒ½
        const viewSwitchBtn = document.getElementById('viewSwitchBtn');
        const viewSwitchMenu = document.getElementById('viewSwitchMenu');
        
        if (viewSwitchBtn && viewSwitchMenu) {
            // è§†å›¾åˆ‡æ¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            viewSwitchBtn.addEventListener('click', () => {
                viewSwitchMenu.classList.toggle('show');
                // åˆ‡æ¢æŒ‰é’®ä¸Šçš„ç®­å¤´æ–¹å‘
                const arrow = viewSwitchBtn.querySelector('span:last-child');
                arrow.textContent = viewSwitchMenu.classList.contains('show') ? 'â–²' : 'â–¼';
            });
    
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå• (æ¢å¤æ­¤åŠŸèƒ½)
            document.addEventListener('click', (e) => {
                if (!viewSwitchBtn.contains(e.target) && !viewSwitchMenu.contains(e.target)) {
                    viewSwitchMenu.classList.remove('show');
                    const arrow = viewSwitchBtn.querySelector('span:last-child');
                    arrow.textContent = 'â–¼'; // èœå•å…³é—­æ—¶ç®­å¤´å‘ä¸‹
                }
            });
    
            // å¤„ç†è§†å›¾åˆ‡æ¢
            document.querySelectorAll('.view-option').forEach(option => {
                option.addEventListener('click', () => {
                    const view = option.dataset.view;
                    
                    if (view === 'map') {
                        window.location.href = 'knowledge-map.html';
                    } else if (view === 'globe') {
                        window.location.href = 'knowledge-globe.html';
                    }
                    // å¦‚æœæ˜¯ treeï¼Œåˆ™ä¸è·³è½¬
                    viewSwitchMenu.classList.remove('show');
                });
            });
        }
    </script>
    
    <!-- åº•éƒ¨å¯¼èˆªæ  -->
    <div class="bottom-nav">
        <a href="knowledge-map.html" class="bottom-nav-item">
            <div class="bottom-nav-icon">ğŸŒ</div>
            <div>çŸ¥è¯†åœ°å›¾</div>
        </a>
        <a href="knowledge-tree.html" class="bottom-nav-item active">
            <div class="bottom-nav-icon">ğŸŒ³</div>
            <div>çŸ¥è¯†æ ‘</div>
        </a>
        <a href="knowledge-globe.html" class="bottom-nav-item">
            <div class="bottom-nav-icon">ğŸ”®</div>
            <div>çŸ¥è¯†çƒ</div>
        </a>
        <a href="review.html" class="bottom-nav-item">
            <div class="bottom-nav-icon">ğŸ“</div>
            <div>å¤ä¹ </div>
        </a>
        <a href="profile.html" class="bottom-nav-item">
            <div class="bottom-nav-icon">ğŸ‘¤</div>
            <div>æˆ‘çš„</div>
        </a>
    </div>
</body>
</html> 